{% extends "base.html" %}
{% block hash_handler %}
<script type="text/javascript">
  $(function(){
    // Keep a mapping of url-to-container for caching purposes.
    var cache = {
      // If url is '' (no fragment), display this div's content.
      '': $('.bbq-default')
    };
    // Bind an event to window.onhashchange that, when the history state changes,
    // gets the url from the hash and displays either our cached content or fetches
    // new content to be displayed.
    $(window).bind( 'hashchange', function(e) {
      // Get the hash (fragment) as a string, with any leading # removed. Note that
      // in jQuery 1.4, you should use e.fragment instead of $.param.fragment().
      var url = $.param.fragment();
      $( '.bbq-item,.bbq-default,#generalContents' ).hide();
      if(!url || url=='_=_') {
	$('.bbq-default').show();
	$('#tabbox').css('visibility','hidden');
	$('#tabbox2').css('visibility','hidden');
	$('#body').removeClass('bg1');
	return;
      }
      $('.bbq-loading').show();
      if(url=='events'||url=='hospi') {
	$('#generalContents').load(url,function(){
	  $('.bbq-loading').hide();
	  $('#generalContents').show();
	});
	if(url=='hospi'){
	  $("#body").removeClass('bg1');
	  $('#tabbox2').css({'visibility':'visible','left':'-1000px'}).animate({'visibility':'visible','left':'0px'});
	}
	if(url=='events') {
	  $('#tabbox').css({'visibility':'visible','left':'-1000px'}).animate({'visibility':'visible','left':'0px'});
	  $('#body').addClass('bg1');
	  $("#tabbox2").css({'visibility':'hidden'});
	} else {
	  $(".menu").css({visibility:"hidden"});
	  $('#tabbox').css({visibility:"hidden"});
	 // $("#generalContents .tabtext").jScrollPane({showArrows: true,verticalScroll: true, autoReinitialise: true});
	}
	return;
      }
      $('#tabbox').css({'visibility':'visible','left':'-1000px'}).animate({'visibility':'visible','left':'0px'});
      $('#body').addClass('bg1');
      $("#content").addClass('back');
      $(".bbq-item").removeClass("bbq-current");
      if(cache[url]) {
	cache[url].show();
	cache[url].addClass("bbq-current");
	openEvent();
	$('.bbq-loading').hide();
      } else {
	cache[url] = $( '<div class="bbq-item bbq-current"></div>' ).appendTo( '.bbq-content' );

	// Load external content via AJAX. Note that in order to keep this
	// example streamlined, only the content in .infobox is shown. You'll
	// want to change this based on your needs.
	cache[url].load( url, function(){
	  $( '.bbq-loading' ).hide();
	  resetabs();
	});
      }
    })
    $(window).trigger('hashchange');
  });
</script>
{% endblock %}
{% block functions %}{% endblock %}
{% block events_menu %}
  {% for category in event_set %}
  <div id="menu{{forloop.counter}}" class="menu mentab{{forloop.counter}}">
    <div id="menutopcolour{{forloop.counter}}" class="menutopcolour">
    </div>
    <div id="menulist{{forloop.counter}}" class="menulist">
      <ul id="menuhead{{forloop.counter}}" class="menuhead">{{category.0.category}}</ul>
      <ul id="menus{{forloop.counter}}">
      {% for event in category %}
	<li onclick="window.location.href='#events/{{event|slugify}}';$('#body').removeClass('bg1');$('#content').addClass('back');">{{event.title}}</li>
      {% endfor %}
      </ul>
    </div>
  </div>
  {% endfor %}
{% endblock %}
{% block footer %}
<div id="footer">
  <div id="tabbox" class="tabbox">
    <div id="tab1" class="tab">
    </div>
    <div id="tab2" class="tab">
    </div>
    <div id="tab3" class="tab">
    </div>
    <div id="tab4" class="tab">
    </div>
    <div id="tab5" class="tab">
    </div>
    <div id="tab6" class="tab">
    </div>
    <div id="tab7" class="tab">
    </div>
    <div id="tab8" class="tab">
    </div>
    <div id="tab9" class="tab">
    </div>
    <div id="tab10" class="tab">
    </div>
    <div id="tab11" class="tab">
    </div>
  </div>
    <div id="tabbox2" class="tabbox">
    <div id="htab1" class="htab">
    </div>
    <div id="htab2" class="htab">
    </div>
    <div id="htab3" class="htab">
    </div>
    <div id="htab4" class="htab">
    </div>
    <div id="htab5" class="htab">
    </div>
    <div id="htab6" class="htab">
    </div>
    <div id="htab7" class="htab">
    </div>
    <div id="htab8" class="htab">
    </div>
    <div id="htab9" class="htab">
    </div>
    <div id="htab10" class="htab">
    </div>
    <div id="htab11" class="htab">
    </div>
     <div id="htab12" class="htab">
    </div>
  </div>
</div>
{% endblock %}
