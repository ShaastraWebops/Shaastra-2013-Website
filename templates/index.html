{% extends "base.html" %}
{% block hash_handler %}
<style>
#dock {
				display: block;
				margin: 30px auto;
				top: 0px;
				width: 100%;
				height:150px;
				text-align: center;
				overflow: hidden;
			}

			#dock ul {
				//margin: 0px -60px;
				padding: 0px;
				list-style: none;
				height: 150px;
				line-height: 130px;
				text-align: center;
				white-space: nowrap;
				display: inline-block;
				//background: url("img/dock-middle.png") bottom left repeat-x;
			}

			#dock ul:before,
			#dock ul:after {
				content: "";
				color: transparent;
				display: inline-block;
				width: 0px;
				//padding-top: 60px;
				//margin-top: -60px;
				//vertical-align: bottom;
			}

			#dock ul:before {
				//padding-left: 60px;
				//margin-left: -60px;
				background: url("img/dock-left.png") bottom left repeat-x;
			} 

			#dock ul:after {
				//padding-right: 60px;
				//margin-right: -60px;
				background: url("img/dock-right.png") bottom right repeat-x;
			}

			/* Dock Icons */
			#dock li {
				display: inline-block;
				vertical-align: bottom;
				margin: 0px;
				padding: 0px;
				position: relative;
				overflow: visible;
			}

			/*#dock li.seperator {
				background: url("img/dock-seperator.png") bottom left no-repeat;
				width: 20px;
				height: 135px;
				position: relative;
				vertical-align: bottom;
			}*/

			#dock li a {
				height: 135px;
				width: 118px;
				display: inline-block;
				text-align: center;
				position: relative;
				vertical-align: bottom;
				text-decoration: none;
				color: black;
				white-space: normal;
				letter-spacing: normal;	
				//line-height: 1.3em;
				text-align: center;
				font-family: Arial;
				//padding-top: 40px;
				//margin-bottom: 5px;
				//overflow: visible;
			}
			
			body.no_js #dock li a:hover {
				width: 124px !important;
			}

			#dock li a span {
				position: relative;
				line-height: 1.3em;
				display: none;
				text-align: center;
				font-weight: bold;
				font-size: 80%;
				padding: 4px 12px;
				background-color: #EEE;
				
				opacity: 0.4;
				-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=40)";
				
				margin: 0px auto;
				
				top: -40px;
				
				border-radius: 10px;
				-moz-border-radius: 10px;
				-webkit-border-radius: 10px;
			}

			#dock li a:hover span {
				display: inline-block;
			}

			#dock li a:hover span:after {
				display: block;
				//height: 9px;
				color: transparent;
				background: transparent url("img/span.png") center top no-repeat;
				position: absolute;
				content: "";
				text-align: center;
				margin: 0px;
				padding: 0px;
				width: 100%;
				margin-left: -16px;
			}

			#dock li a img {
				height: auto;
				width: 100%;
				position: absolute;
				left: 0px;
				//bottom: 10px;
				text-align: center;
				border: 0px none;
				//margin-bottom: 15px;
				
				box-reflect: below 1px gradient(linear, left top, left bottom, from(transparent), color-stop(0.5, transparent), to(rgba(255,255,255,0.1)));
				-webkit-box-reflect: below 1px -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(0.5, transparent), to(rgba(255,255,255,0.1)));
				-moz-box-reflect: below 1px -moz-gradient(linear, left top, left bottom, from(transparent), color-stop(0.5, transparent), to(rgba(255,255,255,0.1)));
			}
		</style>

		<!--[if lte IE 7]-->
		<style>
			/* Inline block fix */
			#dock ul {
				display: inline;
				zoom: 1;
			}

			#dock li, #dock li a {
				display: inline;
				zoom: 1;
			}

			/* Image quality fix */
			img {
				-ms-interpolation-mode: bicubic;
			}

			#dock li a span {
				filter: alpha(opacity=40);
			}
		</style>
<script type="text/javascript">
    $(function(){
        // Keep a mapping of url-to-container for caching purposes.
        var cache = {
            // If url is '' (no fragment), display this div's content.
            '': $('.bbq-default')
        };

        // Bind an event to window.onhashchange that, when the history state changes,
        // gets the url from the hash and displays either our cached content or fetches
        // new content to be displayed.
        $(window).bind( 'hashchange', function(e) {

            // Get the hash (fragment) as a string, with any leading # removed. Note that
            // in jQuery 1.4, you should use e.fragment instead of $.param.fragment().
            var url = $.param.fragment();
            $( '.bbq-item,.bbq-default,#generalContents' ).hide();
            if(!url) {
                $('.bbq-default').show();
                $('#tabbox').css('visibility','hidden');
                $('#trans').removeClass('bg1');
                return;
            }
            if(url=='events'||url=='hospi') {
                $('.bbq-loading').show();
                $('#generalContents').load(url,function(){
                    $('.bbq-loading').hide();
                    $('#generalContents').show();
                });
                if(url=='events') {
                    $('#tabbox').css({'visibility':'visible','left':'-1000px'}).animate({left:'0px'});
                    $('#body').addClass('bg1'); 
                } else {
                    $(".menu").css({visibility:"hidden"});
                    $('#tabbox').css({visibility:"hidden"});
                    $("#generalContents .tabtext").jScrollPane({showArrows: true,verticalScroll: true, autoReinitialise: true});
                }
                return;
            }
            var event_name=url.split('/tab')[0];
            if(cache[event_name]) {
                var event = cache[event_name];
		        var height2 = event.find('#textbox2').height();
		        if(height2>345)              
			        event.find("#textbox2").jScrollPane({showArrows: true,verticalScroll: true, autoReinitialise: true});
                if(cache[url]) {
                    event.find(".tabtext").html(cache[url]);
            		var lgth = cache[url].length;
			        if(lgth>600)
                        event.find("#textbox").jScrollPane({showArrows: true,verticalScroll: true, autoReinitialise: true});
                    else
                        event.find("#textbox").jScrollPane({showArrows: true,verticalScroll: false, autoReinitialise: true});
                } else {
                    $('.bbq-loading').show();
                    event.find(".tabtext").load( url, function(){
                        // Content loaded, hide "loading" content.
                        $( '.bbq-loading' ).hide();
                		var height = event.find('.tabtext').height();
		                if(height>400)
                            event.find("#textbox").jScrollPane({showArrows: true,verticalScroll: true, autoReinitialise: true});
                        else
                            event.find("#textbox").jScrollPane({showArrows: true,verticalScroll: false, autoReinitialise: true});
                        resetabs();
                        cache[url] = $(this).html();
                    });
                }
                event.show();
            } else {
                cache[event_name] = $( '<div class="bbq-item"></div>' ).appendTo( '.bbq-content' );

                // Load external content via AJAX. Note that in order to keep this
                // example streamlined, only the content in .infobox is shown. You'll
                // want to change this based on your needs.
                $('.bbq-loading').show();
                cache[event_name].load( event_name, function(){
                    var height=cache[event_name].find("#textbox2").height();
                  	cache[event_name].find('.eventtab:first').addClass('on');
        			if(height>345)
                        cache[event_name].find("#textbox2").jScrollPane({showArrows: true,verticalScroll: true, autoReinitialise: true});
                    cache[event_name].find(".tabtext").load( url, function(){
                        // Content loaded, hide "loading" content.
                        var height2=$(this).height();
			            if(height2>400){
                            cache[event_name].find("#textbox").jScrollPane({showArrows: true,verticalScroll: true, autoReinitialise: true});}
                        $( '.bbq-loading' ).hide();
                        resetabs();
                        cache[url] = $(this).html();
                        });
                    });
            }
        })
        $(window).trigger('hashchange');

    });
</script>
		<script>
			//library
			function distance(x0, y0, x1, y1) {
				var xDiff = x1-x0;
				var yDiff = y1-y0;
				
				return Math.sqrt(xDiff*xDiff + yDiff*yDiff);
			}
			
			$(document).ready(function() {
				var proximity = 180;
				var iconSmall = 118, iconLarge = 124; //css also needs changing to compensate with size
				var iconDiff = (iconLarge - iconSmall);
				var mouseX, mouseY;
				var dock = $("#dock");
				var animating = false, redrawReady = false;
				
				$(document.body).removeClass("no_js");
				
				//below are methods for maintaining a constant 60fps redraw for the dock without flushing
				$(document).bind("mousemove", function(e) {
					if (dock.is(":visible")) {
						mouseX = e.pageX;
						mouseY = e.pageY;
					
						redrawReady = true;
						registerConstantCheck();
					}
				});
				
				function registerConstantCheck() {
					if (!animating) {
						animating = true;
						
						window.setTimeout(callCheck, 15);
					}
				}
				
				function callCheck() {
					sizeDockIcons();
					
					animating = false;
				
					if (redrawReady) {
						redrawReady = false;
						registerConstantCheck();
					}
				}
				
				//do the maths and resize each icon
				function sizeDockIcons() {
					dock.find("li").each(function() {
						//find the distance from the center of each icon
						var centerX = $(this).offset().left + ($(this).outerWidth()/2.0);
						var centerY = $(this).offset().top + ($(this).outerHeight()/2.0);
						
						var dist = distance(centerX, centerY, mouseX, mouseY);
						
						//determine the new sizes of the icons from the mouse distance from their centres
						var newSize =  (1 - Math.min(1, Math.max(0, dist/proximity))) * iconDiff + iconSmall;
						$(this).find("a").css({width: newSize});
					});
				}
			});
		</script>
{% endblock %}
{% block functions %}
{% endblock %}
{% block events_menu %}
    {% for category in event_set %}
    <div id="menu{{forloop.counter}}"class="menu mentab{{forloop.counter}}">
	    <div id="menutopcolour{{forloop.counter}}" class="menutopcolour">
        </div>
        <div id="menulist{{forloop.counter}}" class="menulist">
        <ul id="menuhead{{forloop.counter}}" class="menuhead">
        	{{category.0.category}}
        </ul>
        <ul id="menus{{forloop.counter}}">
            {% for event in category %}
     		<li onclick="window.location.href='#events/{{event|slugify}}/tab/{{event.tab_set.all.0.title|slugify}}';$('#body').removeClass('bg1');">{{event.title}}</li>
            {% endfor %}
	    </ul>
        </div>
    </div>
    {% endfor %}
{% endblock %}
{% block footer %}

 <div id="footer">
    
    <div id="tabbox">
    <!--<ul>
     <li><a id="tab1" class="tab"></a></li>
     <li><a id="tab2" class="tab"></a></li>
     <li><a id="tab3" class="tab"></a></li>
     <li><a id="tab4" class="tab"></a></li>
     <li><a id="tab5" class="tab"></a></li>
     <li><a id="tab6" class="tab"></a></li>
     <li><a id="tab7" class="tab"></a></li>
     <li><a id="tab8" class="tab"></a></li>
     <li><a id="tab9" class="tab"></a></li>
     <li><a id="tab10" class="tab"></a></li>
    </ul>-->
    	<div id="tab1" class="tab">
         
        </div>
     <div id="tab2" class="tab">
            
        </div>
     <div id="tab3" class="tab">
            
        </div>
     <div id="tab4" class="tab">
            
        </div>
     <div id="tab5" class="tab">
            
        </div>
     <div id="tab6" class="tab">
            
        </div>
     <div id="tab7" class="tab">
            
        </div>
     <div id="tab8" class="tab">
            
        </div>
     <div id="tab9" class="tab">
            
        </div>
      <div id="tab10" class="tab">
            
        </div>
    </div>
    
    </div>

{% endblock %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="static/js/bootstrap-transition.js"></script>
    <script src="static/js/bootstrap-modal.js"></script>
