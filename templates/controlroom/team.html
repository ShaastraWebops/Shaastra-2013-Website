{% load dajaxice_templatetags %}
<html>
<head>
    <title>Shaastra 2013 Control Room</title>
    {% dajaxice_js_import %}
    <link rel="stylesheet" type="text/css" href="{{site_url}}static/css/stylemain.css"  />
    <style type="text/css">
       	body{background:rgb(240,240,240);}
			a.btn{text-decoration: none!important;margin: 0!important;}
			.container{padding:20px 0px;}
			label{font-size:15px;}
			span.helptext{font-size:12px;font-style: italic;}
	 </style>
    <script language = 'JavaScript' type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" charset = "utf-8"></script>
    <script language = 'JavaScript' type="text/javascript" src="{{site_url}}static/js/jquery.dajax.core.js" charset = "utf-8"></script>
    <script language = 'JavaScript' type="text/javascript" src="{{site_url}}static/js/jquery.ba-serializeobject.min.js" charset = "utf-8"></script>
    <script type="text/javascript" charset = "utf-8">
    function send_participants(){
            data = $('#Form').serializeObject();
            if(data.room=='0'){alert('Please select a room');return false;}
            if(data.checkin=='0'){alert('Please select a check-in control room');return false;}
            if(!data.sub_checklist){alert('Select a participant!');return false;}
            $(".bbq-item").prepend("Processing please wait..<br><img src='{{site_url}}static/img/loading.gif'>");
            Dajaxice.controlroom.send_participants(Dajax.process,{'form':data})
            return false;
    }
    function toggleChecked(status){
            $(".checkbox").each( function(){
                $(this).attr("checked", status);
                })
        }

    </script>
</head>
<body>
    <div class="container">
    <a class="btn btn-large btn-danger" href='{{site_url}}controlroom/home/'>Home</a>
    <h2>Team Check In</h2><br>
    <div class="TeamCheckIn">
    <form id="Form" action="" method="post">
    {% csrf_token %}
    <table id = "TeamForm" class="table table-striped table-bordered table-condensed">
    <thead>
    <tr>
        <th><input type="checkbox" value="toggle" id="toggle" onclick="toggleChecked(this.checked);"/></th>
        <th width='120'>Shaastra ID</th>
        <th width='120'>First Name</th>
        <th width='120'>Last Name</th>
        <th width='120'>Phone No</th>
        <th width='120'>Check In Control</th>
        <th width='120'>Check Out Control</th>
        <th width='120'>Room</th>
        <th width='120'>Hostel</th>
        <th width='120'>Check In Date</th>
        <th width='120'>Check Out Date</th>
        <th width='120'>Comments</th>
        <!--<th width='120'></th>-->
    </thead>
    <tbody>
    
    {% for m in checkedin_profiles %}
    <tr>
        <td><input type="checkbox" name="sub_checklist" class="checkbox" value="{{m.shaastra_ID|safe}}" /></td>
        <td width ='120'>{{m.shaastra_ID}}</td>
        <td width ='120'>{{m.first_name}}</td>
        <td width ='120'>{{m.last_name}}</td>
        <td width ='120'>{{m.phone_no}}</td>
        <td width ='120'>{{m.check_in_control_room}}</td>
        <td width ='120'>{{m.check_out_control_room}}</td>
        <td width ='120'>{{m.room.room_no}}</td>
        <td width ='120'>{{m.room.hostel}}</td>
        <td width ='120'>{{m.check_in_date}}</td>
        <td width ='120'>{{m.check_out_date}}</td>
        <td width ='120'>{{m.comments}}</td>
        <!--<td width ='120'></td>-->
    </tr>    
    {% endfor %}
 
    {% for m in new_profiles %}
    <tr>
        <td><input type="checkbox" name="sub_checklist" class="checkbox" value="{{m.shaastra_id|safe}}" /></td>
        <td width ='120'>{{m.shaastra_id}}</td>
        <td width ='120'>{{m.user.first_name}}</td>
        <td width ='120'>{{m.user.last_name}}</td>
        <td width ='120'>{{m.mobile_number}}</td>
        <td width ='120'></td>
        <td width ='120'></td>
        <td width ='120'></td>
        <td width ='120'></td>
        <td width ='120'></td>
        <td width ='120'></td>
        <td width ='120'></td>
        <!--<td width ='120'><a target ="_blank" href = "{{site_url}}controlroom/checkin/{{m.shaastra_id}}" class="btn btn-primary">Check In</a></td>-->

    </tr>
    {% endfor %}
    
    </tbody>
    </table>
    </div>
    <select id="room" name="room">
      <option selected="selected" value="0">---------</option>
      {% for r in rooms %}
      <option value={{r.id|safe}}>{{r}}</option>
      {% endfor %}
    </select><br>
    <select id="checkin" name="checkin">
      <option selected="selected" value="0">---------</option>
      {% for h in hostels %}
      <option value={{h|cut:"("|cut:"'"|cut:","|safe}}>{{h}}</option>
      {% endfor %}
    </select><br>
    <label>Comments</label><textarea id="comments" name="comments"></textarea>
    <input type="button" onclick="send_participants();" value="Allot Room" class="btn btn-info"><br><br>
    </form>
  </div>  

</body>
</html>
