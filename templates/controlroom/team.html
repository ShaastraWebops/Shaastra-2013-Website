{% load dajaxice_templatetags %}
<html>
<head>
    <title>Shaastra 2013 Control Room</title>
    
    <link rel="stylesheet" type="text/css" href="{{site_url}}static/css/stylemain.css"  />
    <style type="text/css">
       	body{background:rgb(240,240,240);}
			a.btn{text-decoration: none!important;margin: 0!important;}
			.container{padding:20px 0px;}
			label{font-size:15px;}
			span.helptext{font-size:12px;font-style: italic;}
	 </style>
    {% dajaxice_js_import %}
    <script language = 'JavaScript' type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" charset = "utf-8"></script>
    <script language = 'JavaScript' type="text/javascript" src="{{site_url}}static/js/jquery.dajax.core.js" charset = "utf-8"></script>
    <script language = 'JavaScript' type="text/javascript" src="{{site_url}}static/js/jquery.ba-serializeobject.min.js" charset = "utf-8"></script>
    <script type="text/javascript" src="{{site_url}}static/js/chosen.jquery.js"></script>
    <script type="text/javascript">
        function load_room(){
            html="<td><div id='selectroom'></div></td>";
            $("table tr:eq(2)").append(html);
            //html="<option value='{{checkedin.room.id}}' selected='selected'>Sindhu,1001</option>"
            //$("#id_room").prepend(html);
            $('.chzn-select').chosen();
            } 
            $(document).ready(function(){
	            load_room();
               $("#selectroom").click(function(){
                    $(this).hide();
                    
                    
               });
            });
    </script>
    <link href="{{site_url}}static/css/chosen.css"  type="text/css" rel="stylesheet">    
    <script type="text/javascript" charset = "utf-8">
    function send_participants(id){
            $("#allot_room_button").attr("disabled","true");
            data = $('#Form').serializeObject();
            if(data.room=='0'){alert('Please select a room');return false;}
            if(data.checkin=='0'){alert('Please select a check-in control room');return false;}
            if(!data.sub_checklist){alert('Select a participant!');return false;}
            $(".bbq-item").prepend("Processing please wait..<br><img src='{{site_url}}static/img/loading.gif'>");
            Dajaxice.controlroom.send_participants(Dajax.process,{'form':data,'uid':id})            
            return false;
    }
    function toggleChecked(status){
            $(".checkbox").each( function(){
                $(this).attr("checked", status);
                })
        }
    </script>
</head>
<body>
    <div class="container">
    <a class="btn btn-large btn-danger" href='{{site_url}}controlroom/home/'>Home</a>
    <a class="btn btn-large btn-inverse" href='{{site_url}}controlroom/team');" >Back</a>
    <h2>Team Check In</h2><br>
    
    <div class="TeamCheckIn">
    <form id="Form" action="{{site_url}}controlroom/teambill/" method="post">
    {% csrf_token %}
    <input type = "hidden" name="leader_id" value = "{{leader.id}}">
    <table id = "TeamForm" class="table table-striped table-bordered table-condensed">
    <thead>
    <tr>
        <th><input type="checkbox" value="toggle" id="toggle" onclick="toggleChecked(this.checked);"/></th>
        <th width='120'>Shaastra ID</th>
        <th width='120'>Gender</th>
        <th width='120'>First Name</th>
        <th width='120'>Last Name</th>
        <th width='120'>Phone No</th>
        <th width='120'>Check In Control</th>
        <th width='120'>Check Out Control</th>
        <th width='120'>Room</th>
        <th width='120'>Hostel</th>
        <th width='120'>Mattress Room</th>
        <th width='120'>Check In Date</th>
        <th width='120'>Check Out Date</th>
        <th width='120'>Comments</th>
        <!--<th width='120'></th>-->
    </thead>
    <tbody>
    
    {% for m in checkedin_profiles %}
    <tr>
        <td><input for ="sub_checklist" type="checkbox" name="sub_checklist" class="checkbox" value="{{m.shaastra_ID}}" /></td>
        <td width ='120'>{{m.shaastra_ID}}</td>
        <td width ='120'>{{m.gender}}</td>
        <td width ='120'>{{m.first_name}}</td>
        <td width ='120'>{{m.last_name}}</td>
        <td width ='120'>{{m.phone_no}}</td>
        <td width ='120'>{{m.check_in_control_room}}</td>
        <td width ='120'>{{m.check_out_control_room}}</td>
        <td width ='120'>{{m.room.room_no}}</td>
        <td width ='120'>{{m.room.hostel}}</td>
        <td width ='120'>{{m.mattress_room}}</td>
        <td width ='120'>{{m.check_in_date}}</td>
        <td width ='120'>{{m.check_out_date}}</td>
        <td width ='120'>{{m.comments}}</td>
        <!--<td width ='120'></td>-->
    </tr>    
    {% endfor %}
 
    {% for m in new_profiles %}
    <tr>
        <td><input for = "sub_checklist" type="checkbox" name="sub_checklist" class="checkbox" value="{{m.shaastra_id}}" /></td>
        <td width ='120'>{{m.shaastra_id}}</td>
        <td width ='120'>{{m.gender}}</td>
        <td width ='120'>{{m.user.first_name}}</td>
        <td width ='120'>{{m.user.last_name}}</td>
        <td width ='120'>{{m.mobile_number}}</td>
        <td width ='120'></td>
        <td width ='120'></td>
        <td width ='120'></td>
        <td width ='120'></td>
        <td width ='120'></td>
        <td width ='120'></td>
        <td width ='120'></td>
        <td width ='120'></td>
        <!--<td width ='120'><a target ="_blank" href = "{{site_url}}controlroom/checkin/{{m.shaastra_id}}" class="btn btn-primary">Check In</a></td>-->

    </tr>
    {% endfor %}
    
    </tbody>
    </table>
    </div>
    <label>Room</label>
    <select for="room" id="room" class="chzn-select" name="room">
      <option selected="selected" value="0">---------</option>
      {% for r in rooms %}
      <option value={{r.id}}>{{r}}</option>
      {% endfor %}
    </select><br>
    <label>Check In Control Room</label>
    <select for="checkin" id="checkin" name="checkin">
      <option selected="selected" value="0">---------</option>
      {% for h in checkin %}
      <option value={{h|cut:"("|cut:"'"|cut:","}}>{{h}}</option>
      {% endfor %}
    </select><br>
    <label>Duration of Stay</label><textarea for="no_of_days" id="no_of_days" name="no_of_days"></textarea>
    <label>Number of mattresses given</label><textarea for="mattresses" id="mattresses" name="mattresses"></textarea>
    <label>Mattress Room</label>
    <select for="mattroom" id="mattroom" name="mattroom">
      <option selected="selected" value="0">---------</option>
      {% for h in matt %}
      <option value={{h|cut:"("|cut:"'"|cut:","}}>{{h}}</option>
      {% endfor %}
    </select><br>
    <label>Comments</label><textarea for="comments" id="comments" name="comments"></textarea>
    <input type="button" id="allot_room_button" onclick="send_participants({{leader.id}});" value="Allot Room" class="btn btn-info"><br><br>
    <!--<input type="button" onclick="generate_bill({{leader.id}});" value="Generate Bill" class="btn btn-info"><br><br>-->
    <!--<input type="submit" value = "Generate Bill">-->
    <!--<a target ="_blank" class="btn btn-large btn-inverse" href='{{site_url}}controlroom/bill/{{leader.id}}/1');" >Generate Bill for Boys</a>
    <a target ="_blank" class="btn btn-large btn-inverse" href='{{site_url}}controlroom/bill/{{leader.id}}/2');" >Generate Bill for Girls</a>-->
    </form>
    
  </div>  

</body>
</html>
